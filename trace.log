+ clear
+ set -eo pipefail
+ DEBUG=true
+ OTEL_ENABLED=true
+++ dirname ./start-services.sh
++ cd .
++ pwd
+ SCRIPT_DIR=/Users/Sameep.Mondhe/learning/ms/microservices-with-java
+ OTEL_AGENT_PATH=/Users/Sameep.Mondhe/learning/ms/microservices-with-java/otel/opentelemetry-javaagent.jar
+ CONFIG_SERVER_PORT=8888
+ EUREKA_PORT=8761
+ ACCOUNTS_PORT=8081
+ LOANS_PORT=8082
+ CARDS_PORT=8083
+ CUSTOMERS_PORT=8084
+ GATEWAY_PORT=8072
+ OBS_STACK_SERVICES=(loki promtail grafana)
+ JAVA_REQUIRED_MAJOR=21
+ DOCKER_BUILD_ARGS=
+ SERVICES_DOCKER_ORDER=("eureka-server:$EUREKA_PORT" "accounts:$ACCOUNTS_PORT" "loans:$LOANS_PORT" "cards:$CARDS_PORT" "customers:$CUSTOMERS_PORT" "gateway-server:$GATEWAY_PORT")
+ LOCAL_SERVICES=("config-server:$CONFIG_SERVER_PORT")
+ trap cleanup_on_exit EXIT
+ echo -e '\nüîÑ Starting microservices deployment...'
+ log_step 'Running preflight checks...'
+ echo -e '\nüîπ Running preflight checks...'
+ REQUIRED_CMDS=(java docker jq curl lsof)
+ missing=()
+ for cmd in '"${REQUIRED_CMDS[@]}"'
+ command -v java
+ for cmd in '"${REQUIRED_CMDS[@]}"'
+ command -v docker
+ for cmd in '"${REQUIRED_CMDS[@]}"'
+ command -v jq
+ for cmd in '"${REQUIRED_CMDS[@]}"'
+ command -v curl
+ for cmd in '"${REQUIRED_CMDS[@]}"'
+ command -v lsof
+ [[ 0 -gt 0 ]]
+ log_success 'All required commands present.'
+ echo -e '  ‚úÖ All required commands present.'
++ java -version
++ head -n1
+ JAVA_VERSION_OUTPUT='Picked up JAVA_TOOL_OPTIONS: -javaagent:./otel/opentelemetry-javaagent.jar'
++ echo 'Picked up JAVA_TOOL_OPTIONS: -javaagent:./otel/opentelemetry-javaagent.jar'
++ sed -E 's/.*version "([0-9]+).*/\1/'
+ JAVA_MAJOR='Picked up JAVA_TOOL_OPTIONS: -javaagent:./otel/opentelemetry-javaagent.jar'
+ [[ Picked up JAVA_TOOL_OPTIONS: -javaagent:./otel/opentelemetry-javaagent.jar -ne 21 ]]
./start-services.sh: line 292: [[: -javaagent:./otel/opentelemetry-javaagent.jar: syntax error in expression (error token is ":./otel/opentelemetry-javaagent.jar")
+ log_success 'Java runtime OK: Picked up JAVA_TOOL_OPTIONS: -javaagent:./otel/opentelemetry-javaagent.jar'
+ echo -e '  ‚úÖ Java runtime OK: Picked up JAVA_TOOL_OPTIONS: -javaagent:./otel/opentelemetry-javaagent.jar'
+ docker info
+ log_error 'Docker daemon not reachable. Start Docker Desktop and retry.'
+ echo -e '  ‚ùå Docker daemon not reachable. Start Docker Desktop and retry.'
+ exit 1
+ cleanup_on_exit
+ local code=1
+ [[ 1 -ne 0 ]]
+ log_error 'Script exited unexpectedly (code=1). Some services may still be running.'
+ echo -e '  ‚ùå Script exited unexpectedly (code=1). Some services may still be running.'
